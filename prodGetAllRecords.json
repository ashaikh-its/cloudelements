{"id":5778,"name":"prodGetAllRecords","description":"Get Ticket records from Autotask and dump into SQL Azure database table","userId":154529,"accountId":154251,"createdDate":"2018-04-13T12:38:59Z","steps":[{"id":56877,"onSuccess":["loopTicketFirstPage"],"onFailure":["SetNextPageFirst"],"name":"getTicketsFirstPage","type":"elementRequest","properties":{"api":"/hubs/${config.sourceElement}/${config.source}","query":"","method":"GET","elementInstanceId":"${config.sourceInstance}"}},{"id":57450,"onSuccess":["postTickets"],"onFailure":["loopTickets"],"name":"isRecordExists","type":"filter","properties":{"body":"done(steps.dbRetrieveTicket.response.body.providerMessage === 'Record does not exist.');"}},{"id":57449,"onSuccess":["isRecordExists"],"onFailure":[],"name":"dbRetrieveTicket","type":"elementRequest","properties":{"body":"${steps.loopTickets.response.body}","api":"/hubs/db/${config.destination}/{objectId}","method":"GET","elementInstanceId":"${config.destinationInstance}"}},{"id":56878,"onSuccess":["loopTickets"],"onFailure":["dbRetrieveTicket"],"name":"postTickets","type":"elementRequest","properties":{"body":"${steps.loopTickets.entry}","api":"/hubs/${config.destinationElement}/${config.destination}","method":"POST","elementInstanceId":"${config.destinationInstance}"}},{"id":57393,"onSuccess":["getTicketsFirstPage"],"onFailure":[],"name":"getQuery","type":"script","properties":{"body":"done({\n  \"query\":{\n    \"q\":\"select * from \" + config.source + \" where createDate >= '2018-01-01T00:00:00+0000' and createDate < '2018-04-16T00:00:00+0000'\"}\n});"}},{"id":56882,"onSuccess":["GetNextPage"],"onFailure":[],"name":"SetPageNumber","type":"script","properties":{"body":"if (steps.SetPageNumber) {\n  done({ \n    \"query\":{\n      \"page\":steps.SetPageNumber.query.page + 1\n    }\n  });\n}\n\ndone({ \n  \"query\":{\n    \"page\":2\n  }\n});"}},{"id":56881,"onSuccess":["postTickets"],"onFailure":["loopTickets"],"name":"isNull","type":"filter","properties":{"body":"if (steps.loopTickets.entry.AtId !== '') {\n  done(true);\n}\ndone(false);"}},{"id":56880,"onSuccess":["isNullFirstPage"],"onFailure":["SetNextPageFirst"],"name":"loopTicketFirstPage","type":"loop","properties":{"list":"${steps.getTicketsFirstPage.response.body}"}},{"id":56879,"onSuccess":["loopTicketFirstPage"],"onFailure":[],"name":"postTicketFirstPage","type":"elementRequest","properties":{"body":"${steps.loopTicketFirstPage.entry}","api":"/hubs/${config.destinationElement}/${config.destination}","method":"POST","elementInstanceId":"${config.destinationInstance}"}},{"id":56876,"onSuccess":["postTicketFirstPage"],"onFailure":["loopTicketFirstPage"],"name":"isNullFirstPage","type":"filter","properties":{"body":"if (steps.loopTicketFirstPage.entry.AtId !== '') {\n  done(true);\n}\ndone(false);"}},{"id":56875,"onSuccess":["loopTickets"],"onFailure":[],"name":"GetNextPage","type":"elementRequest","properties":{"api":"/hubs/${config.sourceElement}/${config.source}","retry":"false","query":"${steps.SetPageNumber.query}","method":"GET","retryAttempts":"3","elementInstanceId":"${config.sourceInstance}","retryDelay":"5"}},{"id":56874,"onSuccess":["isNull"],"onFailure":["isLastPage"],"name":"loopTickets","type":"loop","properties":{"list":"${steps.GetNextPage.response.body}"}},{"id":56873,"onSuccess":["SetPageNumber"],"onFailure":[],"name":"SetNextPageFirst","type":"script","properties":{"body":"done({ \n  \"query\":{\n    \"page\":2\n  }\n});"}},{"id":56872,"onSuccess":["SetPageNumber"],"onFailure":[],"name":"isLastPage","type":"filter","properties":{"body":"if (steps.GetNextPage.response.body.length !== 0) {\n  done(true);\n}\ndone(false);"}}],"triggers":[{"id":5196,"onSuccess":["getTicketsFirstPage"],"onFailure":[],"type":"manual","async":true,"name":"trigger","properties":{}}],"debugLoggingEnabled":true,"singleThreaded":false,"active":true,"configuration":[{"id":16738,"key":"destination","name":"destination","type":"value","required":true},{"id":16739,"key":"destinationElement","name":"destinationElement","type":"value","required":true},{"id":16740,"key":"destinationInstance","name":"destinationInstance","type":"elementInstance","required":true},{"id":16741,"key":"source","name":"source","type":"value","required":true},{"id":16742,"key":"sourceElement","name":"sourceElement","type":"value","required":true},{"id":16743,"key":"sourceInstance","name":"sourceInstance","type":"elementInstance","required":true}]}